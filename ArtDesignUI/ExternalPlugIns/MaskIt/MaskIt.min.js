if(!Array.prototype.indexOf){Array.prototype.indexOf=function(d){if(this==null){throw new TypeError()}var e=Object(this);var b=e.length>>>0;if(b===0){return -1}var f=0;if(arguments.length>1){f=Number(arguments[1]);if(f!=f){f=0}else{if(f!=0&&f!=Infinity&&f!=-Infinity){f=(f>0||-1)*Math.floor(Math.abs(f))}}}if(f>=b){return -1}var c=f>=0?f:Math.max(b-Math.abs(f),0);for(;c<b;c++){if(c in e&&e[c]===d){return c}}return -1}}(function(b){b.fn.maskFields=function(t,e){var w=b.extend({placeholderChar:"_",alwaysDisplayPlaceholder:true},e);var g=null;w.pattern=q(t);var l=[];var j=k(t);var v=0;var d=null;var s=null;function q(B){var C=B.split("");var A=false;for(i=0;i<C.length;i++){switch(C[i]){case"?":if(A){C[i]="sEpArAtOr";A=false}else{C[i]=null}break;case"*":if(!A){C[i]="[a-zA-Z1-9]"}else{C[i]="sEpArAtOr"}A=false;break;case"d":if(!A){C[i]="[1-9]"}else{C[i]="sEpArAtOr"}A=false;break;case"a":if(!A){C[i]="[a-zA-Z]"}else{C[i]="sEpArAtOr"}A=false;break;case"^":if(A){C[i]="sEpArAtOr";A=false}else{C[i]=null;A=true}break;default:var z=false;for(var D in w.specialChars){if(C[i]==D){C[i]=w.specialChars[D];z=true;break}}if(!z){C[i]="sEpArAtOr"}}}while(C.indexOf(null)!=-1){C.splice(C.indexOf(null),1)}return C}function k(A){var B=A.split("");var z=false;for(i=0;i<B.length;i++){switch(B[i]){case"?":if(z){B[i]="?";z=false}else{if(g==null){g=i}B[i]=null}break;case"*":if(!z){B[i]=w.placeholderChar}z=false;break;case"d":if(!z){B[i]=w.placeholderChar}z=false;break;case"a":if(!z){B[i]=w.placeholderChar}z=false;break;case"^":if(z){z=false}else{B[i]=null;z=true}break;default:for(var C in w.specialChars){if(B[i]==C){B[i]=w.placeholderChar;break}}}}while(B.indexOf(null)!=-1){B.splice(B.indexOf(null),1)}if(g==null){g=B.length}return B.join("")}function o(A){var B=0;if(document.selection){A.focus();var z=document.selection.createRange();z.moveStart("character",-A.value.length);B=z.text.length}else{if(A.selectionStart||A.selectionStart=="0"){B=A.selectionStart}}return(B)}function m(D){var G=0,B=0,F,C,A,z,E;if(typeof D.selectionStart=="number"&&typeof D.selectionEnd=="number"){G=D.selectionStart;B=D.selectionEnd}else{C=document.selection.createRange();if(C&&C.parentElement()==D){z=D.value.length;F=D.value.replace(/\r\n/g,"\n");A=D.createTextRange();A.moveToBookmark(C.getBookmark());E=D.createTextRange();E.collapse(false);if(A.compareEndPoints("StartToEnd",E)>-1){G=B=z}else{G=-A.moveStart("character",-z);G+=F.slice(0,G).split("\n").length-1;if(A.compareEndPoints("EndToEnd",E)>-1){B=z}else{B=-A.moveEnd("character",-z);B+=F.slice(0,B).split("\n").length-1}}}}selectionStart=G;selectionEnd=B;if(G==B){selectionStart=null}}function x(z,A){if(z.setSelectionRange){z.setSelectionRange(A,A)}else{if(z.createTextRange){tr=z.createTextRange();tr.collapse(true);tr.moveEnd("character",A);tr.moveStart("character",A);tr.select()}}}function n(A){var B=0;for(i=A;i<w.pattern.length;i++){var z=new RegExp("sEpArAtOr");if(z.test(w.pattern[A+B])){B++}else{break}}return A+B>=w.pattern.length?0:B}function f(A){var B=1;for(i=A;i<w.pattern.length;i++){var z=new RegExp("sEpArAtOr");if(z.test(w.pattern[A+B])){B++}else{break}}return A+B>=w.pattern.length?0:B}function r(A){var B=1;for(i=A;i>0;i--){var z=new RegExp("sEpArAtOr");if(z.test(w.pattern[A-B])){B++}else{break}}return A-B<0?0:B}function y(A,z,C){l[C]=z;var B=j.split("");for(a=0;a<l.length;a++){if(l[a]!=undefined){B[a]=l[a]}}b(A).val(B.join(""))}function p(A){var B=j.split("");var z=0;for(a=0;a<B.length;a++){if(l[a]!=undefined){B[a]=l[a];z=a}if(B[a]==w.placeholderChar){B[a]=""}}B.splice(z+(!z?0:1),B.length-z);b(A).val(B.join(""))}function c(z){var A=j.split("");for(a=0;a<A.length;a++){if(l[a]!=undefined){A[a]=l[a]}}b(z).val(A.join(""))}function h(z){for(a=0;a<g;a++){if(w.pattern[a]!="sEpArAtOr"){if(l[a]==undefined){return false}}}return true}function u(A,B,z){for(a=B;a<z;a++){if(l[a]!=undefined){l[a]=undefined}}}this.each(function(){if(w.alwaysDisplayPlaceholder){c(this)}else{b(this).val("")}b(this).bind("focus",function(A){var z=o(this);c(this);x(this,z)});b(this).bind("blur",function(z){if(!h(this)){l=[];if(w.alwaysDisplayPlaceholder){c(this)}else{b(this).val("")}}else{if(w.alwaysDisplayPlaceholder){c(this)}else{if(!w.alwaysDisplayPlaceholder){p(this)}}}});b(this).bind("mouseup",function(z){m(this)});b(this).bind("keydown",function(B){if(w.onKeyDown!=undefined){if(!w.onKeyDown(B,this)){return false}}var A=o(this);var z=(typeof B.which=="number")?B.which:B.keyCode;if(z==8){if(selectionStart!=null){u(this,selectionStart,selectionEnd);c(this);x(this,selectionStart);selectionStart=null}else{y(this,undefined,A-r(A));x(this,A-r(A))}return false}else{if(z==46){if(selectionStart!=null){u(this,selectionStart,selectionEnd);c(this);x(this,selectionStart);selectionStart=null}else{y(this,undefined,A);x(this,A)}return false}else{if(z==37){if(B.shiftKey){m(this);if(selectionStart){selectionStart--}}else{x(this,A-r(A));return false}}else{if(z==39){if(B.shiftKey){m(this);if(selectionEnd<w.pattern.length){selectionEnd++}}else{x(this,A+f(A));return false}}}}}});b(this).bind("keypress",function(D){if(D.shiftKey){if(D.keyCode==39||D.keyCode==37){return}else{if(D.keyCode==9){return true}}}else{if(D.keyCode==9){return true}}var C=o(this);if(C>=w.pattern.length){return false}C=C+n(C);x(this,C);t=w.pattern[C];var z=new RegExp(t);var A=(typeof D.which=="number")?D.which:D.keyCode;var B=String.fromCharCode(A);if(!z.test(B)){return false}else{y(this,B,C);x(this,C+f(C));if(h(this)){if(w.onCompleted!=undefined){w.onCompleted(D,this)}}return false}})});return this}})(jQuery);